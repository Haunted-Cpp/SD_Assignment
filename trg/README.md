# Distributed Systems Practical Assignment
## Mutual Exclusion with the Token Ring Algorithm 


### Using the .jar files provided

The project has been compiled into several ```.jar``` files to facilitate execution on DCC Lab computers.

#### Launch the calculator server

Simply execute:

```
java -jar calculatorServer.jar {port}
```

The calculator server will be launched on ```localhost``` at the designated ```port```.

#### Launch the peers

Simply execute:

```
java -jar trg.jar {port} {forwardingHost} {calculatorHost}
```

This will launch a peer on ```localhost``` at the designated ```port```.

Moreover, ```forwardingHost``` and ```calculatorHost``` should contain the hostnames of the computers where the token will be forwarded and where the calculator server is hosted, respectively.

#### Inject Start Token

Simply execute:

```
java -jar injectStart.jar {port} {network}
```

This will send the starting token to each host listed in ```network``` on the specified ```port```.

In this case, ```network``` should contain a **single** hostname.

#### Inject End Token

Simply execute:

```
java -jar injectEnd.jar {port} {network}
```

This will send a kill signal to each host listed in ```network``` on the specified ```port```.

#### Example

```
@ L802
java -jar trg.jar 12345 L803 L809
@ L803
java -jar trg.jar 12345 L802 L809
@ L809
java -jar calculatorServer.jar 12345
@ any DCC computer with access to L803 (to start the process)
java -jar injectStart.jar 12345 L803
@ any DCC computer with access to L803 (to kill the process)
java -jar injectEnd.jar 12345 L803
```

#### Compiling and running with ```gradle``` 

These ```.jar``` files can be generated by running the command:

```
gradle fatJar
```

This command creates a ```.jar``` file in the ```build/libs/``` folder with all dependencies included.

The target main class is specified in the ```build.gradle``` file. To modify it, update the following line:

```
manifest {
    attributes 'Main-Class': "ds.assign.trg.Peer"         
}
```

For example, it can be modified to:

```
manifest {
    attributes 'Main-Class': "ds.assign.trg.CalculatorServer"         
}
```

This will produce a ```.jar``` that starts the calculator server.  By default, the file is named ```trg.jar```, so rename it if desired.

### Scripts to Run on DCC Computers

1. Start by running the script:

```
bash runner.sh
``` 

2. To begin the process by sending the start signal, execute:

```
bash start.sh
```

3. To terminate the process, use one of the following scripts:

   - To gracefully end **all processes**:

     ``` 
     bash kill_all.sh
     ```

   - To gracefully end **the process** running on a specific host, use:

     ``` 
     bash kill_one.sh {hostname}
     ```

This will create a (ring) peer network using the hosts:

```L802``` → ```L803``` → ```L804``` → ```L805 ```→ ```L806``` (→ ```L802```)

The calculator server will be hosted on:

```L809```

and a start signal will be sent ```L802```.

The default port being used is: ```51243```
