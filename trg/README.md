# Distributed Systems Practical Assignment
## Mutual Exclusion with the Token Ring Algorithm

### Using the .jar Files Provided

The project has been compiled into several `.jar` files to facilitate execution on DCC Lab computers.

#### Launch the Calculator Server

Simply execute:

```
java -jar calculatorServer.jar {port}
```

This will launch the calculator server on `localhost` at the designated `port`.

#### Launch the Peers

Execute the following command to launch a peer:


```
java -jar trg.jar {port} {forwardingHost} {calculatorHost}
```


This will launch a peer on `localhost` at the specified `port`.

- `forwardingHost`: The hostname of the computer to which the token will be forwarded.
- `calculatorHost`: The hostname of the computer where the calculator server is hosted.

#### Inject Start Token

Execute:

```
java -jar injectStart.jar {port} {network}
```


This will send the starting token to each host listed in `network` on the specified `port`.

- `network`: This should contain **a single hostname** to send the start token to.

#### Inject End Token

Execute:

```
java -jar injectEnd.jar {port} {network}
```


This will send a kill signal to each host listed in `network` on the specified `port`.

#### Example

Run the following commands on the respective hosts:


```
(@ L802) java -jar trg.jar 12345 L803 L809
(@ L803) java -jar trg.jar 12345 L802 L809
(@ L809) java -jar calculatorServer.jar 12345

@ any DCC computer with access to L803 (to start the process)
java -jar injectStart.jar 12345 L803

@ any DCC computer with access to L803 (to kill the process)
java -jar injectEnd.jar 12345 L803
```


#### Compiling and Running with `gradle`

These `.jar` files can be generated by running the following command:



```
gradle fatJar
```


This command will create a `.jar` file in the `build/libs/` folder with all dependencies included.

The target main class is specified in the `build.gradle` file. To modify it, update the following line:


```
manifest {
    attributes 'Main-Class': "ds.assign.trg.Peer"         
}
```

For example, to produce the calculator server file, modify it to:

```
manifest {
    attributes 'Main-Class': "ds.assign.trg.CalculatorServer"         
}
```


By default, the file is named `trg.jar`. Rename it if desired to match the desired main class (`calculatorServer.jar`).

### Scripts to Run on DCC Computers

1. Start by running the script:


```
bash runner.sh
``` 

2. To begin the process by sending the start signal, execute:

```
bash start.sh
```


3. To terminate the process, use one of the following scripts:

   - To gracefully end **all processes**:

     ``` 
     bash kill_all.sh
     ```

   - To gracefully end **the process** running on a specific host, use:

     ``` 
     bash kill_one.sh {hostname}
     ```

### Example Peer Network

This will create a (ring) peer network using the following hosts:

```L802``` → ```L803``` → ```L804``` → ```L805``` → ```L806``` → (→ ```L802```)

The calculator server will be hosted on:

```L809```

The start signal will be sent to `L802`.

The default port being used is: `51243`
