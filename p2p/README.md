# Distributed Systems Practical Assignment
## Count the Number of Nodes in a P2P Network

### Using the .jar Files Provided

The project has been compiled into several `.jar` files to facilitate execution on DCC Lab computers.

#### Launch the Peers

Simply execute:



```
java -jar p2p.jar {timeout} {port} {known hosts}
```


This will launch a peer on `localhost` at the designated `port`.

- `timeout`: A variable that determines the number of **seconds** a host keeps the record of another host. If this amount of time passes without receiving any other information, the host is considered offline and removed.
- `known hosts`: The list of hosts the peer initially knows about.

#### Inject Start Token

Simply execute:


```
java -jar injectStart.jar {port} {network}
```


This will send the starting token to each host listed in `network` on the specified `port`.

- `network`: Should contain **all** the hostnames of the computers involved in the process.

#### Inject End Token

Simply execute:



```
java -jar injectEnd.jar {port} {network}
```


This will send a kill signal to each host listed in `network` on the specified `port`.

#### Example


```
(@ L802) java -jar p2p.jar 60 12345 L803
(@ L803) java -jar p2p.jar 60 12345 L802

@ any DCC computer with access to L802 and L803 (to start the process)
java -jar injectStart.jar 12345 L802 L803

@ any DCC computer with access to L802 (to kill the process running @ L802)
java -jar injectEnd.jar 12345 L802
```


#### Compiling and Running with `gradle`

The `.jar` file can be generated by running the following command:



```
gradle fatJar
```


This command creates a `.jar` file in the `build/libs/` folder with all dependencies included.

### Scripts to Run on DCC Computers

1. Start by running the script:



```
bash runner.sh
``` 


2. To begin the process by sending the start signal, execute:


```
bash start.sh
```

3. To terminate the process, use one of the following scripts:

   - To gracefully end **all processes**:

     ``` 
     bash kill_all.sh
     ```

   - To gracefully end **the process** running on a specific host, use:

     ``` 
     bash kill_one.sh {hostname}
     ```

This will create the following p2p network (similar to the example), given in an adjacency list format:

```L802```: ```L803```

```L803```: ```L802``` ```L804``` ```L805```

```L804```: ```L803```

```L805```: ```L803``` ```L806``` ```L807```

```L806```: ```L805```

```L807```: ```L805```

and a start signal will be sent to all the hosts.

The default port being used is: `51243`
